% !TEX root = ../paper.tex

\begin{prf}
  There are many definitions that can be used to identify a non-singular
  M-matrix; one
  definition gives that an M-matrix can be identified by verifying both of the
  following properties \cite{plemmons}:
  \begin{enumerate}
    \item strict positivity of diagonal entries: $A_{i,i} > 0$, $\forall i$ and
    \item non-positivity of off-diagonal entries: $A_{i,j} \leq 0$,
      $\forall i$, $\forall j\ne i$.
  \end{enumerate}
%-------------------------------------------------------------------------------
First, we show that the off-diagonal elements of the matrix
$\A^L$ are non-positive.
The diffusion matrix entry $D^L_{i,j}$ is bounded as follows:
\begin{eqnarray*}
   D_{i,j}^L & = & \sumKSij\nu^L_K d_K(\test_j,\test_i)\\
          & = & \sumKSij\max\limits_{k\ne \ell\in \indices_K}
            \pr{\frac{\max(0,A_{k,\ell})}
              {-\sum\limits_{T\in\mathcal{K}(S_{k,\ell})}
              \mkern-20mu d_T(\test_\ell,\test_k)}} d_K(\test_j,\test_i) \eqp
\end{eqnarray*}
For an arbitrary quantity $c_{k,\ell} \geq 0 \eqc \forall k\ne\ell\in\indices$,
the following is true for $i\ne j\in\indices$:
$\max\limits_{k\ne\ell\in\indices}c_{k,\ell} \geq c_{i,j}$, and thus for $a\leq 0$,
$a\max\limits_{k\ne\ell\in\indices}c_{k,\ell} \leq a c_{i,j}$.
Recall that $d_K(\test_j,\test_i) < 0$ for $j\ne i$.
Thus, we have:
\begin{eqnarray*}
   D^L_{i,j} & \le & \sumKSij \frac{\max(0,A_{i,j})}
    {-\sumKSij[T] d_T(\test_j,\test_i)}
    d_K(\test_j,\test_i) \eqc\\
      & = & -\max(0,A_{i,j}) \frac{\sumKSij d_K(\test_j,\test_i)}
        {\sumKSij[T] d_T(\test_j,\test_i)} \eqc\\
        & = & -\max(0,A_{i,j}) \eqc\\
        & \le & -A_{i,j} \eqp
\end{eqnarray*}
Then applying this relation to the definition of the low-order steady state
matrix gives
\begin{equation*}
  A^L_{i,j}  =   A_{i,j} + D_{i,j}^L  \le 0  \eqp
\end{equation*}
%\begin{eqnarray*}
%  A^L_{i,j} &  =  & A_{i,j} + D_{i,j}^L \eqc\\
%  A^L_{i,j} & \le & A_{i,j} - A_{i,j}   \eqc\\
%  A^L_{i,j} & \le & 0 \eqp
%\end{eqnarray*}
Next it will be shown that the row sums are non-negative.
Using the fact that $\sumj\test_j(\x)=1$ and
$\sumj d_K(\test_j,\test_i)=0$,
\begin{eqnarray*}
   \sumj A^L_{i,j} & = & \sumj \intSij
      \left(\mathbf{f}'(u_h)
        \cdot\nabla\test_j +
      \sigma\test_j\right)\test_i dV +
      \sumj\sumKSij\nu^L
        d_K(\test_j,\test_i)
      \eqc\\
   & = & \intSi\left(
      \mathbf{f}'(u_h)\cdot
      \nabla\sumj\test_j(\x) +
      \sigma(\x)\sumj\test_j(\x)\right)
      \test_i(\x) dV \eqc\\
   \label{eq:rowsum} & = & \intSi\sigma(\x)\test_i(\x) dV
     \eqc\\
   & \ge & 0 \eqp
\end{eqnarray*}
%-------------------------------------------------------------------------------
\begin{rmk}
  If incoming flux boundary conditions are weakly imposed, then the steady-state
  system matrix is modified: $\A\rightarrow\tilde{\A}$, and the low-order
  viscosity then uses the \emph{modified} steady-state matrix $\tilde{\A}$.
  The non-positivity property of the off-diagonal elements still holds.
  The non-negativity property of the row sums also holds, owing to the relation
  $\tilde{A}_{i,j} \geq A_{i,j}$.
\end{rmk}
%-------------------------------------------------------------------------------
If the support $S_i$ is not entirely vacuum ($\sigma(\x)=0$), then the
row sum is \emph{strictly} positive.
Proof of strict positivity of the diagonal elements directly follows from proof
of non-positivity of the off-diagonal elements and strict positivity of the
row sums. Thus both conditions for the non-singular M-matrix property have
been met.
%-------------------------------------------------------------------------------
%\begin{rmk}
%It should be noted that a \emph{singular} M-matrix
%can result if outflow boundary elements are entirely vacuum because the
%resulting matrix may have zero rows. Arguably, this is a moot point because
%one may argue that the problem domain should not extend into a vacuum since
%the solution should not change after entering a vacuum. Nevertheless, one
%should be aware of this loss of generality.
%\end{rmk}
%-------------------------------------------------------------------------------

\end{prf}
