\begin{theorem}{Theta Scheme Local Discrete Maximum Principle}
If the time step size $\dt$ satisfies Equation \eqref{eq:theta_cfl},
\[
   \timestepsize \leq \frac{\massmatrixletter^L_{i,i}}{(1-\theta)
     \ssmatrixletter_{i,i}^{L,\timeindex}}
   \eqc\quad\forall i \eqc
\]
then the solution of the Theta low-order system given
by Equation \eqref{eq:low_theta}
satisfies the following local discrete maximum principle:
\begin{subequations}\label{eq:theta_dmp}
\begin{equation}
  \DMPlowerbound_i(\solutionvector^{L,n+1})
    \leq \solutionletter_i^{L,\timeindex+1}
    \leq \DMPupperbound_i(\solutionvector^{L,n+1})
  \quad\forall i \eqc
\end{equation}
\begin{multline}
   \DMPbounds_i(\solutionvector^{L,n+1})
   \equiv
   \frac{1}{1+\frac{\theta\timestepsize}{\massmatrixletter^L_{i,i}}
       \ssmatrixletter_{i,i}^{L,\timeindex+1}}
     \Bigg[\pr{1 - \frac{(1-\theta)\timestepsize}{\massmatrixletter^L_{i,i}}
     \ssmatrixletter_{i,i}^{L,\timeindex}}\solutionletter_i^\timeindex
     \\
     - \frac{\timestepsize}{\massmatrixletter^L_{i,i}}\pr{
       (1-\theta)\sumjnoti\ssmatrixletter_{i,j}^{L,\timeindex}
         \solutionletter_{\substack{\max\\\min},j\ne i}^\timeindex
       + \theta\sumjnoti\ssmatrixletter_{i,j}^{L,\timeindex+1}
         \solutionletter_{\substack{\max\\\min},j\ne i}^{\timeindex+1}}
     \\
     + \frac{\timestepsize}{\massmatrixletter^L_{i,i}}
       \pr{(1-\theta)\ssrhsletter_i^\timeindex
       + \theta\ssrhsletter_i^{\timeindex+1}}\Bigg] \eqp
\end{multline}
\end{subequations}
where
\[
  \solutionletter_{\substack{\max\\\min},j\ne i}^\timeindex
  \equiv \substack{\max\\\min\limits_{j\ne i\in\indices(\support_i)}}
    \solutionletter_j^\timeindex
  \eqp
\]
\end{theorem}
\begin{proof}
Evaluating row $i$ of the low-order Theta system, given by Equation
\eqref{eq:low_theta},
\[
  \massmatrixletter^L_{i,i}\frac{\solutionletter_i^{L,\timeindex+1}-\solutionletter_i^\timeindex}
    {\timestepsize}
  + (1-\theta)\sumj\ssmatrixletter_{i,j}^{L,\timeindex}\solutionletter_j^\timeindex
  + \theta\sumj\ssmatrixletter_{i,j}^{L,\timeindex+1}\solutionletter_j^{L,\timeindex+1}
  = (1-\theta)\ssrhsletter_i^\timeindex + \theta \ssrhsletter_i^{\timeindex+1},
\]
and rearranging,
\begin{multline*}
   \solutionletter_i^{L,\timeindex+1}
   = \frac{1}{1+\frac{\theta\timestepsize}{\massmatrixletter^L_{i,i}}
       \ssmatrixletter_{i,i}^{L,\timeindex+1}}
     \Bigg[\pr{1 - \frac{(1-\theta)\timestepsize}{\massmatrixletter^L_{i,i}}
     \ssmatrixletter_{i,i}^{L,\timeindex}}\solutionletter_i^\timeindex
     \\
     - \frac{\timestepsize}{\massmatrixletter^L_{i,i}}\pr{
       (1-\theta)\sumjnoti\ssmatrixletter_{i,j}^{L,\timeindex}\solutionletter_j^\timeindex
       + \theta\sumjnoti\ssmatrixletter_{i,j}^{L,\timeindex+1}\solutionletter_j^{\timeindex+1}}
     + \frac{\timestepsize}{\massmatrixletter^L_{i,i}}
       \pr{(1-\theta)\ssrhsletter_i^\timeindex + \theta\ssrhsletter_i^{\timeindex+1}}\Bigg] \eqp
\end{multline*}
By Lemma \ref{lem:offdiagonalnegative}, it is known that the off-diagonal
elements $\ssmatrixletter^{L,\timeindex}_{i,j}, j\ne i$, are non-positive, and by Equation
\eqref{eq:theta_cfl} the term $1 -
\frac{(1-\theta)\timestepsize}{\massmatrixletter^L_{i,i}}\ssmatrixletter_{i,i}^{L,\timeindex}$
is non-negative. Thus, the following inequality is able to be applied:
\begin{multline*}
   \solutionletter_i^{L,\timeindex+1}
   \le \frac{1}{1+\frac{\theta\timestepsize}{\massmatrixletter^L_{i,i}}
       \ssmatrixletter_{i,i}^{L,\timeindex+1}}
     \Bigg[\pr{1 - \frac{(1-\theta)\timestepsize}{\massmatrixletter^L_{i,i}}
     \ssmatrixletter_{i,i}^{L,\timeindex}}\solutionletter_i^\timeindex
     \\
     - \frac{\timestepsize}{\massmatrixletter^L_{i,i}}\pr{
       (1-\theta)\sumjnoti\ssmatrixletter_{i,j}^{L,\timeindex}
         \solutionletter_{\max,j\ne i}^\timeindex
       + \theta\sumjnoti\ssmatrixletter_{i,j}^{L,\timeindex+1}
         \solutionletter_{\max,j\ne i}^{\timeindex+1}}
     \\
     + \frac{\timestepsize}{\massmatrixletter^L_{i,i}}
       \pr{(1-\theta)\ssrhsletter_i^\timeindex
       + \theta\ssrhsletter_i^{\timeindex+1}}\Bigg] \eqp
\end{multline*}
and similarly for the lower bound.\qed
\end{proof}
