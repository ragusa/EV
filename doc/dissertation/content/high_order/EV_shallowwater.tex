The entropy function for the shallow water equations is defined to be
the sum of the kinetic and potential energy terms, in terms of the
conservative variables and the bathymetry function $\bathymetry$:
\begin{equation}
  \entropy(\vectorsolution,\bathymetry)
  = \half\frac{\heightmomentum\cdot\heightmomentum}
  {\height} + \half\gravity\height\pr{\height+\bathymetry}
  \eqp
\end{equation}
% REMARK ======================================================================
\begin{remark}
Omission of the bathymetry term in the potential energy
term in the entropy definition has no effect on either the entropy
residual or entropy jump due to the assumption that $\bathymetry$ is
not a function of time. Thus in implementation, the following definition
can be used:
\begin{equation}
  \entropy(\vectorsolution)
  = \half\frac{\heightmomentum\cdot\heightmomentum}
  {\height} + \half\gravity\height^2
  \eqc
\end{equation}
which is often more convenient since it is a function of the conservative
variables only.
\end{remark}
%==============================================================================
The entropy flux, derived in Appendix \ref{sec:shallow_water_entropy_flux}, is the
following:
\begin{equation}
  \mathbf{\consfluxletter}^\entropy(\vectorsolution,\bathymetry)
  = \gravity(\height + \bathymetry)\heightmomentum
  + \half\frac{\pr{\heightmomentum\cdot\heightmomentum}\heightmomentum} 
  {\height^2}
  \eqp
\end{equation}
The entropy residual is defined to be the left hand side of 
Equation \eqref{eq:shallowwater_entropy_equality}:
\begin{equation}
  \entropyresidual(\vectorsolution) \equiv \partial_\timevalue\entropy
  + \divergence\mathbf{\consfluxletter}^\entropy
  \eqp
\end{equation}
The entropy jump for a face $F$ is defined to be
\begin{equation}
  \entropyjump_F(\vectorsolution)
  \equiv \left\|
    \jumpbrackets{\nabla\mathbf{\consfluxletter}^\entropy}
    \cdot\normalvector\cdot\normalvector
  \right\|_{L^\infty(F)} \eqp
\end{equation}
Finally, the entropy viscosity is computed as in the scalar case but with
more generality in the normalization constant $c^{\text{normalization},\timeindex}_q$:
\begin{equation}
   \entropycellviscosity[n]
     = \max\limits_{\x_q\in \mathcal{Q}_\cell}\pr{\frac{\entropyresidualcoef
     |\entropyresidual_q^\timeindex|
     + \entropyjumpcoef\entropyjump_\cell^\timeindex}
     {c^{\text{normalization},\timeindex}_q}}
   \eqc
\end{equation}
where $\mathcal{Q}_\cell$ is the set of quadrature points in cell $\cell$.
As in the scalar case, one may normalize using the deviation from the average
entropy:
\begin{equation}
  c^{\text{normalization},\timeindex}_q
    = \entropy(\approximatevectorsolution^\timeindex(\x_q))
   -\bar{\entropy}(\approximatevectorsolution^\timeindex)
  \eqp
\end{equation}
Alternately, for the shallow water equations, the following local normalization
constant may be used:
\begin{equation}
  c^{\text{normalization},\timeindex}_q
  = \gravity (\approximate{h}^\timeindex(\x_q))^2
  \eqp
\end{equation}

