\section{Test Problem Descriptions}
In this section, the test problem suite is described. These descriptions
include the domain, initial conditions, boundary conditions, and other
physical parameters.
%================================================================================
\subsection{Multi-Region Unit Hypercube}\label{sec:multi_region}
In this section, a class of test problems is described that use a unit
hypercube $(0,1)^d$ as the domain, where $d$ is the number of
spatial dimensions. The hypercube has a number $N_r$ of uniform regions
in which the source $q$ and reaction cross section $\sigma$ are
constant. Thus each of the test problems that fit in this
category can be fully described by:
\begin{itemize}
  \item the positions of the interfaces between the regions,
    $[r_1,\ldots,r_{N_r-1}]$ (the positions $r_0$ and $r_{N_r}$
    refer to the hypercube boundaries 0 and 1, respectively),
  \item the source strengths in each region, $q_0,\ldots,q_{N_r-1}$:
    $q(\x) = q_i,\qquad $
  \item the cross sections in each region, $\sigma_0,\ldots,\sigma_{N_r-1}$,
\end{itemize}

Exact Solution
\[
  u(\x,t) = u_b + u_q \eqc
\]
\[
  u_b=\tilde{u_0}(x-ct)e^{-\tau},
        \quad N_r=3,\quad
        \tau = \sum\limits_{i=0}^{N_r-1} \sigma_i s_i \eqc
\]
\[
  \tilde{u_0}(x) = \left\{\begin{array}{l l}
        u_{inc}, & x<x_0\\
        0,       & x\geq 0
     \end{array}\right. \eqc
\]
\[
  u_q=\sum\limits_{i=0}^{N_r-1}u_{q,i}e^{-\tau_i},\quad
        \tau_i = \sum\limits_{j=i+1}^{N_r-1} \sigma_j s_j \eqc
\]
\[
  u_{q,i} = \left\{\begin{array}{l l}
        \frac{q_i}{\sigma_i}\left(1-e^{-\sigma_i s_i}\right), & \sigma_i\neq 0\\
        q_i s_i, & \sigma_i = 0
        \end{array}\right. \eqc
\]
%================================================================================
\subsection{Void-to-Absorber}\label{sec:void_to_absorber}
This problem examines the angular flux travelling in the $+x$ direction,
starting in a void and reaching a strong absorber region.
Table \ref{tab:void_to_absorber} summarizes the test parameters.

\begin{table}[h]\caption{Void-to-Absorber Test Problem Summary}
\label{tab:void_to_absorber}
\centering
\begin{tabular}{l l}\toprule
\emph{Parameter} & \emph{Value}\\\midrule
Domain & $\mathcal{D} = (0,1)^d$\\
Initial Conditions & $u_0(\x)=0$\\
Boundary Conditions & $u(\x,t)=1,\quad \x\in\partial\mathcal{D}^-,\quad t>0,
   \quad\partial\mathcal{D}^-=\{\x\in\partial\mathcal{D}:\mathbf{n}(\x)
   \cdot\mathbf{\Omega}<0\}$\\
Direction & $\mathbf{\Omega} = \mathbf{e}_x$\\
Cross Section & $\sigma(\x)=\left\{\begin{array}{c l}
   10, & \x\in(\frac{1}{2},1)^d\\
   0,  & \mbox{otherwise}\end{array}\right.$\\
Source & $q(\x,t)=0$\\
Speed & $c=1$\\
Exact Solution & $u(\x,t)=\left\{\begin{array}{l l}
   \left\{\begin{array}{l l}
      e^{-10(x-\frac{1}{2})}, & x\ge\frac{1}{2}, y\ge\frac{1}{2}, z\ge\frac{1}{2}\\
      1,                      & \mbox{otherwise}
   \end{array}\right., & x-t<0\\
   0, & \mbox{otherwise}
   \end{array}\right.$ \\
\bottomrule\end{tabular}
\end{table}
%================================================================================
\subsection{Skew Void-to-Absorber}\label{sec:skew_void_to_absorber}
This problem is a more general case of the test problem described in
Section \ref{sec:void_to_absorber} in which the transport direction is
not necessarily the $+x$ direction but instead is any direction for which
$\Omega_i\ge 0,\forall i$.
Table \ref{tab:void_to_absorber_skew} summarizes the test parameters,
where the definition of $s$ is given below.

\begin{table}[h]\caption{Skew Void-to-Absorber Test Problem Summary}
\label{tab:void_to_absorber_skew}
\centering
\begin{tabular}{l l}\toprule
\emph{Parameter} & \emph{Value}\\\midrule
Domain & $\mathcal{D} = (0,1)^d$\\
Initial Conditions & $u_0(\x)=0$\\
Boundary Conditions & $u(\x,t)=1,\quad \x\in\partial\mathcal{D}^-,\quad t>0,
   \quad\partial\mathcal{D}^-=\{\x\in\partial\mathcal{D}:\mathbf{n}(\x)
   \cdot\mathbf{\Omega}<0\}$\\
Direction & $\mathbf{\Omega} = \left[\frac{1}{\sqrt{2}},\frac{1}{\sqrt{3}},
   \frac{1}{\sqrt{6}}\right]$\\
Cross Section & $\sigma(\x)=\left\{\begin{array}{c l}
   10, & \x\in(\frac{1}{2},1)^d\\
   0,  & \mbox{otherwise}\end{array}\right.$\\
Source & $q(\x,t)=0$\\
Speed & $c=1$\\
Exact Solution & $u(\x,t)=\left\{\begin{array}{l l}
   \left\{\begin{array}{l l}
      e^{-10s}, & x\ge\frac{1}{2}, y\ge\frac{1}{2}, z\ge\frac{1}{2}\\
      1,        & \mbox{otherwise}
   \end{array}\right., & \x-\mathbf{\Omega}t\notin\mathcal{D}\\
   0, & \mbox{otherwise}
   \end{array}\right.$ \\
\bottomrule\end{tabular}
\end{table}

The condition $\x-\mathbf{\Omega}t\notin\mathcal{D}$ is equivalent to the
following condition:
\[
   \x-\mathbf{\Omega}t\notin\mathcal{D} \Rightarrow
   \exists i: x_i-\Omega_i t < 0,
\]
where $i$ denotes a coordinate direction index $x$, $y$, or $z$.
The distance travelled in the absorber region, $s$, is computed
by first determining which plane segment of the absorber region
through which the line $\x-\mathbf{\Omega}t$ passes; the coordinate
direction normal to this plane is denoted by $i$ and the other
two by $j$ and $k$. This is determined as follows:
\[
   i: \frac{x_i-\frac{1}{2}}{\Omega_i} = \min\limits_j\left(
      \frac{x_j-\frac{1}{2}}{\Omega_j}\right).
\]
Then, $s$ is computed as follows:
\[
   s=\sqrt{s_i^2 + s_j^2 + s_k^2}, \quad
   s_i=x_i-\frac{1}{2}, \quad
   s_j=\frac{\Omega_j}{\Omega_i}s_i, \quad
   s_k=\frac{\Omega_k}{\Omega_i}s_i.
\]
%================================================================================
\subsection{Three-Region}\label{sec:three_region}
This is a 1-D problem that consists of a domain with 3 regions of differing
saturation values $\frac{q}{\sigma}$. This is used to test both reaction
terms and source terms.
Table \ref{tab:three_region} summarizes the test parameters.

\begin{table}[h]\caption{Three-Region Test Problem Summary}
\label{tab:three_region}
\centering
\begin{tabular}{l l}\toprule
\emph{Parameter} & \emph{Value}\\\midrule
Domain & $\mathcal{D} = (0,1)$\\
Initial Conditions & $u_0(\x)=0$\\
Boundary Conditions & $u(\x,t)=u_{inc}=1,\quad \x\in\partial\mathcal{D}^-,\quad t>0,$\\
   & $\partial\mathcal{D}^-=\{\x\in\partial\mathcal{D}:\mathbf{n}(\x)
     \cdot\mathbf{\Omega}<0\}$\\
Direction & $\mathbf{\Omega} = \mathbf{e}_x$\\
Cross Section & $\sigma(\x)=\left\{\begin{array}{c l}
   \sigma_0, & x\in[x_0,x_1]\\
   \sigma_1, & x\in(x_1,x_2]\\
   \sigma_2, & x\in(x_2,x_3]
   \end{array}\right.,\quad
   \left[\begin{array}{c}\sigma_0\\\sigma_1\\\sigma_2\end{array}\right] =
      \left[\begin{array}{c}1\\40\\20\end{array}\right]$\\
   & $\left[\begin{array}{c}x_0\\x_1\\x_2\\x_3\end{array}\right] =
      \left[\begin{array}{c}0\\0.3\\0.6\\1\end{array}\right]$\\
Source & $q(\x,t)=\left\{\begin{array}{c l}
   q_0, & x\in[x_0,x_1]\\
   q_1, & x\in(x_1,x_2]\\
   q_2, & x\in(x_2,x_3]
   \end{array}\right.,\quad
   \left[\begin{array}{c}q_0\\q_1\\q_2\end{array}\right] =
      \left[\begin{array}{c}1\\5\\20\end{array}\right]$\\
Speed & $c=1$\\
Exact Solution & $u(\x,t) = u_b + u_q$\\
   & $u_b=\tilde{u_0}(x-ct)e^{-\tau},
        \quad N_r=3,\quad
        \tau = \sum\limits_{i=0}^{N_r-1} \sigma_i s_i,$\\
   & $\tilde{u_0}(x) = \left\{\begin{array}{l l}
        u_{inc}, & x<x_0\\
        0,       & x\geq 0
     \end{array}\right.$,\\
   & $u_q=\sum\limits_{i=0}^{N_r-1}u_{q,i}e^{-\tau_i},\quad
        \tau_i = \sum\limits_{j=i+1}^{N_r-1} \sigma_j s_j,$\\
   & $u_{q,i} = \left\{\begin{array}{l l}
        \frac{q_i}{\sigma_i}\left(1-e^{-\sigma_i s_i}\right), & \sigma_i\neq 0\\
        q_i s_i, & \sigma_i = 0
        \end{array}\right.$,\\
   & $s_i = \max(s^+_i-s^-_i,0),\quad
     s^+_i = \min(x,x_{i+1}),\quad
     s^-_i = \max(x-ct,x_i)$ \\
\bottomrule\end{tabular}
\end{table}
%================================================================================
\subsection{Saturation Value Test}\label{sec:saturation}
This is a 1-D problem that consists of a domain with 2 regions of equal
saturation values $\frac{q}{\sigma}$, but with significantly individual values
of $\sigma$ and $q$ individually. The exact solution should show no
evidence of the interface between the two regions.
Table \ref{tab:saturation} summarizes the test parameters.

\begin{table}[h]\caption{Saturation Value Test Problem Summary}
\label{tab:saturation}
\centering
\begin{tabular}{l l}\toprule
\emph{Parameter} & \emph{Value}\\\midrule
Domain & $\mathcal{D} = (0,1)$\\
Initial Conditions & $u_0(\x)=0$\\
Boundary Conditions & $u(\x,t)=u_{inc}=1,\quad \x\in\partial\mathcal{D}^-,\quad t>0,$\\
   & $\partial\mathcal{D}^-=\{\x\in\partial\mathcal{D}:\mathbf{n}(\x)
     \cdot\mathbf{\Omega}<0\}$\\
Direction & $\mathbf{\Omega} = \mathbf{e}_x$\\
Cross Section & $\sigma(\x)=\left\{\begin{array}{c l}
   \sigma_0, & x\in[x_0,x_1]\\
   \sigma_1, & x\in(x_1,x_2]
   \end{array}\right.,\quad
   \left[\begin{array}{c}\sigma_0\\\sigma_1\end{array}\right] =
      \left[\begin{array}{c}1\\1\times 10^5\end{array}\right]$\\
   & $\left[\begin{array}{c}x_0\\x_1\\x_2\end{array}\right] =
      \left[\begin{array}{c}0\\0.5\\1\end{array}\right]$\\
Source & $q(\x,t)=\left\{\begin{array}{c l}
   q_0, & x\in[x_0,x_1]\\
   q_1, & x\in(x_1,x_2]
   \end{array}\right.,\quad
   \left[\begin{array}{c}q_0\\q_1\end{array}\right] =
      \left[\begin{array}{c}1\\1\times 10^5\end{array}\right]$\\
Speed & $c=1$\\
Exact Solution & $u(x,t) = 1$ \\
\bottomrule\end{tabular}
\end{table}
%================================================================================
\subsection{1-D Steady-State Sinusoidal MMS Problem}\label{sec:mms_sin_ss}
$x\in(0,\frac{\pi}{4})$

$u(x) = \sin(x) + u^{inc}$

$q(x) = v_x\cos(x) + \sigma(\sin(x) + u^{inc})$

$u(x,t) = e^{\alpha t}\sin(x) + u^{inc}$

$q(x,t) = \alpha e^{\alpha t}\sin(x) + v_x e^{\alpha t}\cos(x)
   + \sigma(e^{\alpha t}\sin(x) + u^{inc})$

2-D ss:

$u(x,y) = \sin(x) + \sin(y) + u^{inc}$

$q(x,y) = v_x\cos(x) + v_y\cos(y) + \sigma(\sin(x) + u^{inc})$

tr:

$u(x,y,t) = e^{\alpha t}\pr{\sin(x) + \sin(y)} + u^{inc}$

$q(x,y,t) = \alpha e^{\alpha t}\pr{\sin(x) + \sin(y)}
   + e^{\alpha t}\pr{v_x \cos(x) + v_y \cos(y)}
   + \sigma(e^{\alpha t}\pr{\sin(x) + \sin(y)} + u^{inc})$

%This problem examines the angular flux travelling in the $+x$ direction,
%starting in a void and reaching a strong absorber region.
%Table \ref{tab:void_to_absorber} summarizes the test parameters.
%
%\begin{table}[h]\caption{Void-to-Absorber Test Problem Summary}
%\label{tab:void_to_absorber}
%\centering
%\begin{tabular}{l l}\toprule
%\emph{Parameter} & \emph{Value}\\\midrule
%Domain & $\mathcal{D} = (0,1)^d$\\
%Initial Conditions & $u_0(\x)=0$\\
%Boundary Conditions & $u(\x,t)=1,\quad \x\in\partial\mathcal{D}^-,\quad t>0,
%   \quad\partial\mathcal{D}^-=\{\x\in\partial\mathcal{D}:\mathbf{n}(\x)
%   \cdot\mathbf{\Omega}<0\}$\\
%Direction & $\mathbf{\Omega} = \mathbf{e}_x$\\
%Cross Section & $\sigma(\x)=\left\{\begin{array}{c l}
%   10, & \x\in(\frac{1}{2},1)^d\\
%   0,  & \mbox{otherwise}\end{array}\right.$\\
%Source & $q(\x,t)=0$\\
%Speed & $c=1$\\
%Exact Solution & $u(\x,t)=\left\{\begin{array}{l l}
%   \left\{\begin{array}{l l}
%      e^{-10(x-\frac{1}{2})}, & x\ge\frac{1}{2}, y\ge\frac{1}{2}, z\ge\frac{1}{2}\\
%      1,                      & \mbox{otherwise}
%   \end{array}\right., & x-t<0\\
%   0, & \mbox{otherwise}
%   \end{array}\right.$ \\
%\bottomrule\end{tabular}
%\end{table}
%================================================================================
