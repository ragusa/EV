%--------------------------------------------------------------------------------
\subsubsection{Definition of $Q_i^\pm$ for $\theta$-Scheme}
%--------------------------------------------------------------------------------
\begin{theorem}{Discrete Maximum Principle-Satisfying Limited Flux Bounds for
  the $\theta$-Scheme}
  Using the $\theta$-scheme FCT scheme
  \begin{equation}\label{thetaFCT}
    \mathbf{M}^L\frac{\mathbf{U}^{n+1}-\mathbf{U}^n}{\Delta t}
    + (1-\theta)\mathbf{A}^L\mathbf{U}^n + \theta\mathbf{A}^L\mathbf{U}^{n+1}
    = (1-\theta)\mathbf{b}^n + \theta\mathbf{b}^{n+1}
    + \mathcal{L}[\mathbf{F}],
  \end{equation}
  the following limited flux bounds $Q_i^\pm$ correspond to the discrete
   maximum principle $W_i^+\le U_i^{n+1}\le W_i^-$:
   \begin{equation}
      Q_i^\pm \equiv m_i\frac{W_i^\pm - U_i^n}{\Delta t}
      +(1-\theta)\sum\limits_j A_{i,j}^L U_j^n
      +\theta\sum\limits_j A_{i,j}^L U_j^{n+1}
      =(1-\theta)b_i^n
      +\theta b_i^{n+1}.
   \end{equation}
\end{theorem}

\begin{proof}
  Starting with row $i$ of Equation \eqref{thetaFCT},
   \[
      m_i\frac{U_i^{n+1}-U_i^n}{\Delta t}
      + (1-\theta)\sum\limits_j A_{i,j}^L U_j^n
      + \theta\sum\limits_j A_{i,j}^L U_j^{n+1}
      = (1-\theta)b_i^n
      + \theta b_i^{n+1}
      + \sum\limits_j\mathcal{L}_{i,j}F_{i,j}.
   \]
   Solving for $\sum\limits_j\mathcal{L}_{i,j}F_{i,j}$ gives
   \[
      \sum\limits_j\mathcal{L}_{i,j}F_{i,j} =
      m_i\frac{U_i^{n+1}-U_i^n}{\Delta t}
      + (1-\theta)\sum\limits_j A_{i,j}^L U_j^n
      + \theta\sum\limits_j A_{i,j}^L U_j^{n+1}
      - (1-\theta)b_i^n
      - \theta b_i^{n+1}
   \]
   The discrete maximum principle is
   \[
      W_i^-\le U_i^{n+1}\le W_i^+.
   \]
   Through addition/subtraction and multiplication/division operations, this
   principle can be made to look like the following:
   \begin{multline*}
   m_i\frac{W_i^--U_i^n}{\Delta t}
      + (1-\theta)\sum\limits_j A_{i,j}^L U_j^n
      + \theta\sum\limits_j A_{i,j}^L U_j^{n+1}
      - (1-\theta)b_i^n
      - \theta b_i^{n+1}\\
   \le m_i\frac{U_i^{n+1}-U_i^n}{\Delta t}
      + (1-\theta)\sum\limits_j A_{i,j}^L U_j^n
      + \theta\sum\limits_j A_{i,j}^L U_j^{n+1}
      - (1-\theta)b_i^n
      - \theta b_i^{n+1}\\
   \le m_i\frac{W_i^+-U_i^n}{\Delta t}
      + (1-\theta)\sum\limits_j A_{i,j}^L U_j^n
      + \theta\sum\limits_j A_{i,j}^L U_j^{n+1}
      - (1-\theta)b_i^n
      - \theta b_i^{n+1},
   \end{multline*}
   which by substituting equations above gives
   \[
      Q_i^-\le\sum\limits_j \mathcal{L}_{i,j}F_{i,j}\le Q_i^+.\qed
   \]
\end{proof}