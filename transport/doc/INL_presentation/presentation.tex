\documentclass{beamer}
\useoutertheme[right]{sidebar}
\setbeamertemplate{items}[square]
\setbeamertemplate{navigation symbols}{}

%\setbeamertemplate{footline}[frame number]

\setbeamercolor{frametitle}{fg=white,bg=red!50!black}
\setbeamercolor{sidebar}{bg=black!20}
\setbeamercolor{logo}{bg=red!30!black}
\setbeamercolor{section in sidebar}{fg=white}              % active section
\setbeamercolor{section in sidebar shaded}{fg=black!50}    % inactive section
\setbeamercolor{subsection in sidebar}{fg=white}           % active subsection
\setbeamercolor{subsection in sidebar shaded}{fg=black!40} % inactive subsection
\setbeamercolor{title}{fg=white,bg=red!50!black}
\setbeamercolor{itemize item}{fg=red!50!black}
\setbeamercolor{itemize subitem}{fg=red!50!black}
\setbeamercolor{itemize subsubitem}{fg=red!50!black}
%\setbeamercolor{author}{fg=white}
%\setbeamercolor{institute}{fg=white}
%\setbeamercolor{date}{fg=white}

\setbeamertemplate{sidebar right}
{
  \insertverticalnavigation{\swidth}
  \vfill
  \hbox to2cm{\hskip0.6cm\usebeamerfont{subsection in sidebar shaded}
   \strut\usebeamercolor[fg]{subsection in
      sidebar shaded}\insertframenumber / \inserttotalframenumber\hfill}
  \vskip3pt
}

\usepackage{multicol}
\input{../dissertation/content/newcommands}

\title[]{A Positivity-Preserving Flux-Corrected Transport Scheme
Using Continuous Finite Elements} 
\author[]{Joshua E. Hansel\inst{1} \and Jean C. Ragusa\inst{1}
   \and Jean-Luc Guermond\inst{2}}
\institute{
  \inst{1}Department of Nuclear Engineering\\
   Texas A\&M University
   \and
   \inst{2}Department of Mathematics\\
   Texas A\&M University}
\date[Summer 2015]{Idaho National Laboratory, Summer 2015}
\logo{\includegraphics[height=0.1\textwidth]{./figures/TAMU-Logo-white.png}}

\begin{document}
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
{
\setbeamercolor{background canvas}{bg=black!10}
\begin{frame}[plain]
   % remove space reserved for sidebar
   \advance\textwidth1.5cm
   \hsize\textwidth
   \columnwidth\textwidth
	
   \titlepage
\end{frame}
}
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
\section{Introduction}
\subsection{Presenter Background}
\begin{frame}
\frametitle{Presenter Background}

\begin{itemize}
   \item Currently PhD nuclear engineering student at Texas A\&M University.
   \item For MS, worked on preconditioning techniques for subchannel methods with
      JFNK.
   \item After MS, implemented entropy-based artificial viscosity for Euler
      equations using the \texttt{deal.II} finite element library.
   \item Currently implementing entropy viscosity (EV) + flux-corrected transport
      (FCT) for transport equations, such as neutron transport equation.
\end{itemize}

\end{frame}
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
\subsection{Motivation}
\begin{frame}
\frametitle{Motivation}

\begin{itemize}
   \item Weak solutions to conservation law problems using standard CFEM
      are not unique and thus are prone to unphysical oscillations:
   \begin{center}
      \includegraphics[width=0.7\textwidth]{./figures/advection_Galerkin.pdf}
   \end{center}
\end{itemize}

\end{frame}
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
\subsection{Objectives}
\begin{frame}
\frametitle{Objectives}

\begin{itemize}
   \item The objectives of this research are the following:
   \begin{itemize}
      \item \textbf{Accurately solve conservation law problems} using the
         continuous finite element method (CFEM).
      \begin{itemize}
         \item Scheme to be presented is 2nd order-accurate in space (for smooth
            problems).
      \end{itemize}
      \item \textbf{Prevent spurious oscillations}.
      \begin{itemize}
	 \item Scheme to be presented is not proven to completely immune to any
            spurious oscillations but shows good results in practice.
      \end{itemize}
      \item \textbf{Prevent negativities} for physically non-negative quantities.
      \begin{itemize}
         \item Scheme to be presented is guaranteed to be positivity-preserving.
      \end{itemize}
   \end{itemize}
\end{itemize}

\end{frame}
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
\subsection{Outline}
\begin{frame}
\frametitle{Outline}

\begin{itemize}
   \item Presentation of scheme for simple case: linear scalar transport
      conservation law
   \begin{itemize}
      \item Explicit time discretizations
      \item Implicit time discretizations
      \item Steady-state
   \end{itemize}
   \item Extension of scheme to more complex cases:
   \begin{itemize}
      \item \emph{linear} scalar conservation laws $\rightarrow$ \emph{nonlinear}
         scalar conservation laws
      \item \emph{scalar} conservation laws $\rightarrow$ conservation law
         \emph{systems}
   \end{itemize}
   \item Possible implementation in MOOSE
\end{itemize}

\end{frame}
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
\section{Methodology}
\subsection{Problem Formulation}
\begin{frame}
\frametitle{Problem Formulation}

\begin{itemize}
   \item Scalar linear conservation law model:
   \begin{align}
      &\pd{u}{t} + \nabla\cdot(\mathbf{v}u\xt)
      + \sigma(\x)u\xt = q\xt\\
      &\sigma(\x)\ge 0,\qquad q\xt\ge 0\nonumber
   \end{align}
   \item Define problem by providing initial conditions and some boundary
      condition, such as Dirichlet:
   \begin{equation}
      u(\x,0) = u^0(\x) \quad \forall \x\in \mathcal{D}
   \end{equation}
   \begin{equation}
      u\xt = u^{inc}(\x) \quad \forall \x\in \partial \mathcal{D}^{inc}
   \end{equation}
   \item CFEM solution:
   \begin{equation}
      u_h\xt = \sum\limits_{j=1}^N U_j(t) \varphi_j(\x),
      \quad \varphi_j(\x)\in P^1_h
   \end{equation}
\end{itemize}

\end{frame}
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
\subsection{Temporal Discretization}
\begin{frame}
\frametitle{Temporal Discretization}

\begin{itemize}
   \item Simplest time discretization is forward Euler (FE), which gives the
      discrete system
   \begin{equation}\label{eq:exgalerkin}
      \M^C\frac{\U^{n+1}-\U^n}{\dt} + \A\U^n = \b^n
   \end{equation}
   \begin{equation}
      M\ij^C \equiv \int\limits_{S\ij}\varphi_i(\x) \varphi_j(\x) d\x
   \end{equation}
   \begin{equation}
      A\ij \equiv \int\limits_{S\ij}\left(
      \nabla\cdot(\mathbf{v}\varphi_j(\x)) +
		\sigma(\x)\varphi_j(\x)\right)\varphi_i(\x) d\x
   \end{equation}
   \begin{equation}
      b_i^n \equiv \int\limits_{S_i} q(\x,t^n)\varphi_i(\x) d\x
   \end{equation}
\end{itemize}

\end{frame}
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
\subsection{FCT Scheme Overview}
\begin{frame}
\frametitle{Flux Corrected Transport (FCT) Scheme}
\framesubtitle{Introduction}

\begin{itemize}
   \item Initially developed in 1973 for finite difference discretizations of
      transport/conservation law problems and recently applied to finite element
      method.
   \item Works by adding conservative fluxes to satisfy physical bounds on the
      solution.
   \item Employs a high-order scheme and a low-order, monotone scheme.
   \item Defines a \emph{correction}, or \emph{antidiffusion}, flux, which
      when added to the low-order scheme, produces the high-order scheme
      solution.
   \item Limits this correction flux to enforce the physical bounds imposed.
\end{itemize}

\end{frame}
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
\subsection{Low-Order Scheme}
\begin{frame}
\frametitle{Low-Order Scheme}
\framesubtitle{Definition}

\begin{itemize}
   \item To get the low-order scheme, one does the following:
   \begin{itemize}
      \item Lumps the mass matrix: $\M^C \rightarrow \M^L$.
      \item Adds a low-order diffusion operator: $\A \rightarrow \A+\D^L$.
   \end{itemize}
   \item This gives the following, where $\U^{L,n+1}$ is the low-order solution:
   \begin{equation}
      \M^L\frac{\U^{L,n+1}-\U^n}{\dt} + (\A + \D^L)\U^n = \b^n
   \end{equation}
   \item The diffusion matrix $\D^L$ is assembled elementwise, where $K$
      denotes an element, using a local bilinear form $b_K$ and a
      local low-order viscosity $\nu_K^L$:
   \begin{equation}
      D\ij^L = \sum\limits_{K\subset S\ij}\nu_K^L b_K(\varphi_j,\varphi_i)
   \end{equation}
\end{itemize}

\end{frame}
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
\begin{frame}
\frametitle{Low-Order Scheme}
\framesubtitle{Local Bilinear Form}

\begin{itemize}
   \item The local bilinear form is defined as follows, where $|K|$ denotes
      the volume of element $K$, $\mathcal{I}(K)$ is the set of indices
      corresponding to degrees of freedom with nonempty support on $K$, and
      $n_K$ is the cardinality of this set.
   \begin{equation}
      b_K(\varphi_j, \varphi_i) \equiv \left\{\begin{array}{l l}
         -\frac{1}{n_K - 1}|K| & i\ne j, \quad i,j\in \mathcal{I}(K)\\
         |K|                   & i = j,  \quad i,j\in \mathcal{I}(K)\\
         0                     & i\notin\mathcal{I}(K)\,|\, j\notin\mathcal{I}(K)
      \end{array}\right.
   \end{equation}
   \item Some properties that result from this definition:
   \begin{equation}
      \sum\limits_j b_K(\varphi_j, \varphi_i) = 0
   \end{equation}
   \begin{equation}
      b_K(\varphi_i, \varphi_i) > 0
   \end{equation}
\end{itemize}

\end{frame}
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
\begin{frame}
\frametitle{Low-Order Scheme}
\framesubtitle{Low-Order Viscosity}

\begin{itemize}
   \item The low-order viscosity is defined as
   \begin{equation}
      \nu_K^L \equiv \max\limits_{i\ne j\in \mathcal{I}(K)}\frac{\max(0,A\ij)}
      {-\sum\limits_{T\subset S\ij} b_T(\varphi_j, \varphi_i)}
   \end{equation}
\end{itemize}

\end{frame}
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
\begin{frame}
\frametitle{Low-Order Scheme}
\framesubtitle{Properties}

\begin{itemize}
   \item These definitions make $(\A + \D^L)$ an M-matrix, which has
      the following desirable consequences for the low-order solution $\U^{L,n+1}$:
   \begin{itemize}
      \item monotonicity
      \item non-negativity
      \item satisfaction of a discrete maximum principle (DMP):
      \begin{equation}
         W_i^-(\U^n)\leq
         U_i^{L,n+1}\leq
         W_i^+(\U^n)\qquad\forall i
      \end{equation}
      \begin{equation}
         W_i^\pm(\U^n) \equiv U_{\substack{\max\\\min},i}^n\left(1-\frac{\dt}{m_i}
         \sum\limits_j A\ij^L\right)
         + \frac{\Delta t}{m_i}b_i^n
      \end{equation}
   \end{itemize}
   \item However, this low-order scheme is only first-order accurate.
\end{itemize}

\end{frame}
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
\begin{frame}
\frametitle{Low-Order Scheme}
\framesubtitle{Results Example}

\includegraphics[width=\textwidth]{./figures/advection_low_order.pdf}

\end{frame}
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
\subsection{High-Order Scheme}
\begin{frame}
\frametitle{High-Order Scheme}
\framesubtitle{Definition}

\begin{itemize}
   \item Add high-order artificial viscosity:
   \begin{equation}
      \M^C\frac{\U^{H,n+1}-\U^n}{\dt} + (\A + \D^{H,n})\U^n = \b^n
   \end{equation}
   \begin{equation}
      D\ij^{H,n} = \sum\limits_{K\subset S\ij}\nu_K^{H,n} b_K(\varphi_j,\varphi_i)
   \end{equation}
   \begin{equation}
      \nu^{H,n}_K = \min(\nu^{L}_K,\nu^{E,n}_K)
   \end{equation}
   \item The entropy-based artificial viscosity $\nu^{E,n}_K$ is
   proportional to local ``entropy'' production.
\end{itemize}

\end{frame}
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
\begin{frame}
\frametitle{High-Order Scheme}
\framesubtitle{Entropy Viscosity Definition}

\begin{itemize}
   \item One chooses a convex entropy function $E(\psi)$ such
   as $E(\psi)=\frac{1}{2}\psi^2$ and manipulates the
   transport equation to get an entropy residual:
   \begin{equation}
      R_K(\psi) = \left\|\pd{E}{t}
      + \frac{dE}{d\psi}\left(\mathbf{\Omega}\cdot\nabla \psi
      + \sigma \psi
      - q \right)\right\|_{L^\infty(K)}
   \end{equation}
   \item Entropy-based artificial viscosity is proportional to an entropy
   residual $R_K^n(\psi_h)$:
   \begin{equation}
      \nu^{E,n}_K = \frac{c_E R_K^n(\psi_h)
      + c_J\max\limits_{F\in\partial K}J_F(\psi_h^n)}
      {\|E(\psi_h^n)-\bar{E}(\psi_h^n)\|_{L^\infty(\mathcal{D})}}
   \end{equation}
\end{itemize}
   
\end{frame}
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
\begin{frame}
\frametitle{High-Order Scheme}
\framesubtitle{Results Example}

%\includegraphics[width=\textwidth]{./figures/advection_high_order.pdf}

\end{frame}
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
\begin{frame}
\frametitle{Flux Corrected Transport (FCT) Scheme}
\framesubtitle{Correction Flux Definition}

\begin{itemize}
   \item Define a correction flux $\f$:
   \begin{align*}
      \f\,\mbox{Def.:}\quad   & \M^L\frac{\U^{H,n+1}-\U^n}{\dt}+(\A+\D^L)\U^n = \b^n + \f^n\\
      \mbox{Low-order:}\quad  & \M^L\frac{\U^{L,n+1}-\U^n}{\dt}+(\A + \D^L)\U^n = \b^n\\
      \mbox{High-order:}\quad & \M^C\frac{\U^{H,n+1}-\U^n}{\dt}+(\A + \D^{H,n})\U^n = \b^n
   \end{align*}
   \item Thus $\f$ is
   \begin{equation}
      \f^n \equiv -(\M^C-\M^L)\frac{\U^{H,n+1}-\U^n}{\dt} +(\D^L-\D^{H,n})\U^n
   \end{equation}
\end{itemize}

\end{frame}
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
\begin{frame}
\frametitle{Flux Corrected Transport (FCT) Scheme}
\framesubtitle{FCT Overview}

\begin{itemize}
   \item Decompose $\f$ into internodal fluxes $F\ij$: $f_i = \sum\limits_j F\ij$:
   \begin{multline}
      F\ij = -M\ij^C\left(\frac{dU_j}{dt}^{H,n+1} - \frac{dU_i}{dt}^{H,n+1}\right)\\
      + (D\ij^L-D\ij^H)(U^n_j - U^n_i)
   \end{multline}
   \item The FCT scheme limits these fluxes with a limiter $\L$:
   \begin{equation}
      \M^L\frac{\U^{n+1}-\U^n}{\dt} + \A^L\U^n = \b + \L[\F]
   \end{equation}
   \item The limiter $\L$ enforces the discrete maximum principle:
   \begin{equation}
         W_i^-(\U^n)\leq
         U_i^{n+1}\leq
         W_i^+(\U^n)\qquad\forall i
   \end{equation}
\end{itemize}

\end{frame}
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
\begin{frame}
\frametitle{Flux Corrected Transport (FCT) Scheme}
\framesubtitle{Limiting Coefficient Definition}

\begin{itemize}
   \item Each correction flux $F\ij$ has an associated limiting
   coefficient $\L\ij$: $\L[\F]_i = \sum\limits_j \L\ij F\ij$:
\begin{equation}\label{eq:P_defs}
   P_i^+ \equiv \sum\limits_j\max(0,F_{i,j}) \qquad
   P_i^- \equiv \sum\limits_j\min(0,F_{i,j})
\end{equation}
\begin{equation}\label{eq:Q_defs}
      Q_i^\pm \equiv m_i\frac{W_i^\pm-U_i^n}{\Delta t}
      + \sum\limits_j A_{i,j}^L U_j^n - b_i
\end{equation}
\begin{equation}\label{eq:R_defs}
   R_i^\pm \equiv\left\{
      \begin{array}{l l}
         1                                          & P_i^\pm = 0\\
         \min\left(1,\frac{Q_i^\pm}{P_i^\pm}\right) & P_i^\pm \ne 0
      \end{array}
      \right.
\end{equation}
\begin{equation}
   \L\ij \equiv\left\{
      \begin{array}{l l}
         \min(R_i^+,R_j^-) & F_{i,j} \geq 0\\
         \min(R_i^-,R_j^+) & F_{i,j} < 0
      \end{array}
      \right.
\end{equation}
\end{itemize}

\end{frame}
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
\begin{frame}
\frametitle{Flux Corrected Transport (FCT) Scheme}
\framesubtitle{Results Example}

%\includegraphics[width=\textwidth]{./figures/advection_FCT.pdf}

\end{frame}
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
\section{Results}
\begin{frame}
\frametitle{Results}
\framesubtitle{Source Problem Results}

%\includegraphics[width=\textwidth]{./figures/solutions_source_FE.pdf}

\end{frame}
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
\begin{frame}
\frametitle{Results}
\framesubtitle{Smooth Problem Convergence Results (Using FE)}

%\includegraphics[width=\textwidth]{./figures/convergence_smooth_FE.pdf}

\end{frame}
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
\begin{frame}
\frametitle{Results}
\framesubtitle{Non-smooth Problem Convergence Results (Using SSPRK33)}

%\includegraphics[width=\textwidth]{./figures/convergence_absorber_SSPRK33.pdf}

\end{frame}
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
\section{Conclusions}
\begin{frame}
\frametitle{Conclusions}

\begin{itemize}
   \item guaranteed non-negative, DMP-satisfying scheme
   \item monotonicity for problems tested, but not guaranteed
   \item theoretical convergence rates observed
   \item future work:
      \begin{itemize}
         \item implicit time discretizations
         \item steady-state
         \item more complicated physics
      \end{itemize}
\end{itemize}

\end{frame}
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
\begin{frame}
\frametitle{Acknowledgments}

\begin{itemize}
   \item Dr. Jean Ragusa, my advisor
   \item Dr. Jean-Luc Guermond, our collaborator and pioneer of the entropy-based
      artificial viscosity method
   \item Dr. Dmitri Kuzmin, an expert in FCT
\end{itemize}
\begin{itemize}
   \item This material is based upon work supported under an Integrated University
      Program Graduate Fellowship.
\end{itemize}

\begin{center}
   \includegraphics[width=0.4\textwidth]{./figures/NEUP_Final_Logo_Version-09.jpg}
\end{center}
\end{frame}
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
\end{document}
