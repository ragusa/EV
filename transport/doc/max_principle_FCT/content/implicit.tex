%================================================================================
\section{Implicit Transient Radiation Transport}
%================================================================================
%--------------------------------------------------------------------------------
\subsection{Deriving a Maximum Principle}
%--------------------------------------------------------------------------------
Here we seek to find a maximum principle for the transient problem, given by
Equation \ref{tr}.
Using implicit Euler for time stepping, the following equation relates the new and old
time step solutions:
\begin{equation}\label{im_newstep}
   U_i^{n+1} + \frac{\Delta t}{m_i}\sum\limits_j U_j^{n+1} A^L_{i,j} =
   U_i^n  + \frac{\Delta t}{m_i}b_i,
\end{equation}
where $\Delta t$ is the time step size, $m_i$ is the $i$th element of the \emph{lumped} mass
matrix, i.e., $M^L_{i,i}$, $\mathbf{A^L}$ is the steady-state system matrix, and
$\mathbf{b}$ is the right-hand side.

\begin{theorem}
The solution at the new time step, $U^{n+1}_i$ satisfies the following maximum principle:
\begin{equation}\label{implicit_max_principle}
   \frac{1}{1+\frac{\Delta t}{m_i}A_{i,i}}\left(U_i^n - \left(\frac{\Delta t}{m_i}
   \sum\limits_{j\ne i} A^L_{i,j}\right)U_{min,i}^{n+1} + \frac{\Delta t}{m_i}b_i\right)
   \le U_i^{n+1} \le
   \frac{1}{1+\frac{\Delta t}{m_i}A_{i,i}}\left(U_i^n - \left(\frac{\Delta t}{m_i}
   \sum\limits_{j\ne i} A^L_{i,j}\right)U_{max,i}^{n+1} + \frac{\Delta t}{m_i}b_i\right),
\end{equation}
where $U_{min,i}^{n+1} = \min\limits_{j\in \mathcal{I}(S_i)}U_j^{n+1}$, $U_{max,i}^{n+1} = \max\limits_{j\in \mathcal{I}(S_i)}U_j^{n+1}$,
and $\mathcal{I}(S_i)$ is the set of indices of degrees of freedom in the support of degree of freedom $i$.
\end{theorem}
\begin{proof}
Rearranging Equation \ref{im_newstep},
\[
   \left(1+\frac{\Delta t}{m_i}A_{i,i}\right)U_i^{n+1} + \frac{\Delta t}{m_i}
      \sum\limits_{j\ne i} U_j^{n+1} A^L_{i,j} = U_i^n  + \frac{\Delta t}{m_i}b_i.
\]
\[
   U_i^{n+1} = \frac{1}{1+\frac{\Delta t}{m_i}A_{i,i}}\left(U_i^n - \frac{\Delta t}{m_i}\sum\limits_{j\ne i} U_j^{n+1} A^L_{i,j} + \frac{\Delta t}{m_i}b_i\right).
\]
By Lemma \ref{offdiagonalnegative}, it is known that the off-diagonal
elements $A^L_{i,j}, j\ne i$, are non-positive. Thus, the following inequality is able to be applied:
\[
   U_i^{n+1} \le
      \frac{1}{1+\frac{\Delta t}{m_i}A_{i,i}}\left(U_i^n - \left(\frac{\Delta t}{m_i}\sum\limits_{j\ne i} A^L_{i,j}\right)U_{max,i}^{n+1} + \frac{\Delta t}{m_i}b_i\right),
\]
and similarly for the lower bound.\qed
\end{proof}